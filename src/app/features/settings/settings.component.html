<div class="settings-container">
  <div class="settings-header">
    <h2>Settings</h2>
    <button class="btn btn-secondary btn-sm" (click)="resetToDefaults()">Reset to Defaults</button>
  </div>

  <!-- Errors -->
  <div class="error-container" *ngIf="validationErrors().length > 0">
    <div class="error-item" *ngFor="let error of validationErrors()">
      {{ error }}
    </div>
  </div>

  <!-- Timer Settings -->
  <section class="settings-section">
    <h3>Timer Durations</h3>

    <div class="setting-item">
      <label for="work-minutes" class="setting-label">
        Work Duration (minutes)
        <span class="setting-hint">1-90 minutes</span>
      </label>
      <input
        id="work-minutes"
        type="number"
        class="setting-input"
        min="1"
        max="90"
        [value]="settings().workMinutes"
        (change)="updateWorkMinutes($any($event.target).value)"
      />
    </div>

    <div class="setting-item">
      <label for="short-break-minutes" class="setting-label">
        Short Break Duration (minutes)
        <span class="setting-hint">1-30 minutes</span>
      </label>
      <input
        id="short-break-minutes"
        type="number"
        class="setting-input"
        min="1"
        max="30"
        [value]="settings().shortBreakMinutes"
        (change)="updateShortBreakMinutes($any($event.target).value)"
      />
    </div>

    <div class="setting-item">
      <label for="long-break-minutes" class="setting-label">
        Long Break Duration (minutes)
        <span class="setting-hint">1-60 minutes</span>
      </label>
      <input
        id="long-break-minutes"
        type="number"
        class="setting-input"
        min="1"
        max="60"
        [value]="settings().longBreakMinutes"
        (change)="updateLongBreakMinutes($any($event.target).value)"
      />
    </div>

    <div class="setting-item">
      <label for="sessions-before-long-break" class="setting-label">
        Sessions Before Long Break
        <span class="setting-hint">2-10 sessions</span>
      </label>
      <input
        id="sessions-before-long-break"
        type="number"
        class="setting-input"
        min="2"
        max="10"
        [value]="settings().sessionsBeforeLongBreak"
        (change)="updateSessionsBeforeLongBreak($any($event.target).value)"
      />
    </div>
  </section>

  <!-- Sound Settings -->
  <section class="settings-section">
    <h3>Sound</h3>

    <div class="setting-item">
      <label for="sound-theme" class="setting-label">Sound Theme</label>
      <select
        id="sound-theme"
        class="setting-select"
        [value]="settings().soundTheme"
        (change)="updateSoundTheme($any($event.target).value)"
      >
        <option *ngFor="let theme of soundThemeOptions" [value]="theme.value">
          {{ theme.label }}
        </option>
      </select>
    </div>

    <div class="setting-item">
      <label for="volume" class="setting-label">
        Volume
        <span class="setting-value">{{ (settings().volume * 100).toFixed(0) }}%</span>
      </label>
      <div class="volume-control">
        <input
          id="volume"
          type="range"
          class="setting-range"
          min="0"
          max="1"
          step="0.1"
          [value]="settings().volume"
          (input)="updateVolume($any($event.target).value)"
        />
        <button class="btn btn-secondary btn-sm" (click)="testSound()">Test Sound</button>
      </div>
    </div>

    <div class="setting-item">
      <label class="setting-checkbox">
        <input
          type="checkbox"
          [checked]="settings().muteWork"
          (change)="updateMuteWork($any($event.target).checked)"
        />
        <span>Mute during work sessions</span>
      </label>
    </div>

    <div class="setting-item">
      <label class="setting-checkbox">
        <input
          type="checkbox"
          [checked]="settings().muteBreak"
          (change)="updateMuteBreak($any($event.target).checked)"
        />
        <span>Mute during breaks</span>
      </label>
    </div>
  </section>

  <!-- Appearance Settings -->
  <section class="settings-section">
    <h3>Appearance</h3>

    <div class="setting-item">
      <label for="theme" class="setting-label">Theme</label>
      <div class="theme-grid">
        <button
          *ngFor="let theme of allThemes()"
          class="theme-option"
          [class.theme-active]="currentTheme().id === theme.id"
          (click)="updateTheme(theme.id)"
          [attr.aria-label]="'Select ' + theme.name + ' theme'"
        >
          <div class="theme-preview">
            <div class="theme-color" [style.background]="theme.colors.primary"></div>
            <div class="theme-color" [style.background]="theme.colors.secondary"></div>
            <div class="theme-color" [style.background]="theme.colors.background"></div>
          </div>
          <div class="theme-name">{{ theme.name }}</div>
        </button>
      </div>
    </div>

    <div class="setting-item">
      <label for="font-family" class="setting-label">Font Family</label>
      <select
        id="font-family"
        class="setting-select"
        [value]="settings().fontFamily"
        (change)="updateFontFamily($any($event.target).value)"
      >
        <option *ngFor="let font of fontFamilyOptions" [value]="font.value">
          {{ font.label }}
        </option>
      </select>
    </div>
  </section>

  <!-- Info -->
  <section class="settings-section">
    <div class="info-box">
      <h4>Keyboard Shortcuts</h4>
      <ul class="shortcuts-list">
        <li><kbd>Space</kbd> or <kbd>K</kbd> - Toggle play/pause</li>
        <li><kbd>R</kbd> - Reset timer</li>
        <li><kbd>N</kbd> - Skip to next phase</li>
        <li><kbd>T</kbd> - Quick add task</li>
        <li><kbd>S</kbd> - Open settings</li>
        <li><kbd>?</kbd> - Show help</li>
      </ul>
    </div>
  </section>
</div>
