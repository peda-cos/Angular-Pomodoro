<div class="statistics-container">
  <h2>Statistics</h2>

  <!-- Today's Stats -->
  <section class="stats-section">
    <h3>Today</h3>
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-value">{{ todayStats().pomodorosCompleted }}</div>
        <div class="stat-label">Pomodoros</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ todayStats().totalMinutes }}</div>
        <div class="stat-label">Focus Minutes</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ todayStats().averageSessionLength }}</div>
        <div class="stat-label">Avg Session (min)</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ todayStats().sessionsCompleted }}</div>
        <div class="stat-label">Total Sessions</div>
      </div>
    </div>
  </section>

  <!-- Weekly Overview -->
  <section class="stats-section">
    <h3>This Week</h3>
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-value">{{ weeklyStats().pomodorosCompleted }}</div>
        <div class="stat-label">Pomodoros</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ weeklyStats().totalMinutes }}</div>
        <div class="stat-label">Focus Minutes</div>
      </div>
    </div>

    <!-- Weekly Chart -->
    <div class="chart-container">
      <h4>Daily Breakdown</h4>
      <div class="bar-chart" role="img" aria-label="Daily focus minutes for the past week">
        <div *ngFor="let day of weeklyStats().dailyBreakdown" class="bar-wrapper">
          <div class="bar-container">
            <div
              class="bar"
              [style.height.%]="getBarHeight(day.totalMinutes)"
              [attr.aria-label]="formatDate(day.date) + ': ' + day.totalMinutes + ' minutes'"
            >
              <span class="bar-value" *ngIf="day.totalMinutes > 0">{{ day.totalMinutes }}</span>
            </div>
          </div>
          <div class="bar-label">{{ formatDay(day.date) }}</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Top Tasks -->
  <section class="stats-section" *ngIf="weeklyStats().topTasks.length > 0">
    <h3>Top Tasks This Week</h3>
    <div class="task-stats-list">
      <div *ngFor="let task of weeklyStats().topTasks; let i = index" class="task-stat-item">
        <div class="task-rank">{{ i + 1 }}</div>
        <div class="task-stat-content">
          <div class="task-stat-title">{{ task.taskTitle }}</div>
          <div class="task-stat-details">
            <span>üçÖ {{ task.pomodoros }}</span>
            <span>‚è±Ô∏è {{ task.minutes }}m</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Empty State -->
  <div
    class="empty-state"
    *ngIf="todayStats().pomodorosCompleted === 0 && weeklyStats().pomodorosCompleted === 0"
  >
    <svg width="64" height="64" fill="var(--color-text-secondary)" viewBox="0 0 24 24">
      <path
        d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"
      />
    </svg>
    <p>No data yet</p>
    <p class="empty-subtitle">Complete your first Pomodoro to see statistics</p>
  </div>
</div>
